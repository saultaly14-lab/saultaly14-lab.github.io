<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emprendimiento Saul Taly - Oficial</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --rojo: #e63946; 
            --negro: #1d3557; 
            --blanco: #ffffff; 
            --gris-claro: #f8f9fa;
            --sombra: 0 10px 30px rgba(0,0,0,0.08);
        }

        /* Fuerza el inicio arriba */
        html { scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; background: var(--gris-claro); margin: 0; padding: 0; color: #333; -webkit-tap-highlight-color: transparent; }
        
        /* PANEL ADMIN */
        #admin-panel { display: none; background: #000; color: #fff; padding: 25px; border-bottom: 5px solid var(--rojo); z-index: 2000; position: relative; }
        .admin-in { width: 95%; padding: 12px; margin-top: 8px; border-radius: 8px; border: 1px solid #444; background: #222; color: white; display: block; margin-bottom: 12px;}

        /* HEADER & LOGO */
        header { padding: 30px 20px; text-align: center; background: white; box-shadow: 0 2px 15px rgba(0,0,0,0.03); border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; }
        .logo-btn { 
            width: 90px; height: 90px; background: var(--negro); border-radius: 50%; 
            margin: 0 auto 15px; border: 4px solid var(--rojo); 
            display: flex; align-items: center; justify-content: center; 
            overflow: hidden; cursor: pointer; box-shadow: 0 5px 15px rgba(230, 57, 70, 0.3);
            position: relative;
        }
        #logo-img { width: 100%; height: 100%; object-fit: cover; display: block; }
        #logo-txt { position: absolute; color: white; font-weight: bold; font-size: 1.5rem; }
        .slogan { color: #666; font-size: 0.85rem; display: block; margin-top: 5px; font-weight: 300; }

        /* BUSCADOR */
        .search-container { width: 90%; max-width: 500px; margin: 20px auto; position: relative; }
        .search-container input { 
            width: 100%; padding: 12px 45px 12px 20px; border-radius: 25px; border: 1px solid #ddd; 
            box-shadow: var(--sombra); outline: none; font-family: inherit; box-sizing: border-box;
        }
        .search-icon { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--rojo); font-size: 1.2rem; }
        
        /* CARRUSEL */
        .slider-container { width: 92%; margin: 20px auto; overflow: hidden; background: #fff; height: 220px; position: relative; border-radius: 25px; box-shadow: var(--sombra); touch-action: pan-y; }
        .slider-track { display: flex; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); height: 100%; }
        .slide { min-width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; }
        .slide img { height: 100%; width: 100%; object-fit: contain; padding: 10px; box-sizing: border-box; }
        .slide-info { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(29, 53, 87, 0.9)); color: white; padding: 15px; text-align: center; }
        .slide-info b { font-size: 1.1rem; text-transform: uppercase; letter-spacing: 1px; }

        .nav-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.4); color: white; border: none; padding: 15px 10px; cursor: pointer; border-radius: 5px; z-index: 10; font-weight: bold; }
        .prev { left: 5px; } .next { right: 5px; }

        /* GRID Y CARDS */
        .container { padding: 20px; max-width: 1000px; margin: auto; padding-bottom: 150px; } 
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(170px, 1fr)); gap: 20px; }
        .card { border: none; border-radius: 20px; padding: 15px; text-align: center; background: white; box-shadow: var(--sombra); scroll-margin-top: 100px; transition: transform 0.3s ease; }
        .img-wrap { width: 100%; height: 160px; overflow: hidden; border-radius: 15px; margin-bottom: 10px; }
        .card img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .card:hover img { transform: scale(1.15); } 
        
        .price-bs { color: var(--rojo); font-weight: 700; font-size: 1.1rem; display: block; margin-top: 5px; }
        .cant-label { font-size: 0.75rem; color: #666; font-weight: 600; display: block; margin-top: 10px; }
        
        .info-footer-box { background: white; padding: 20px; border-radius: 20px; margin-top: 30px; box-shadow: var(--sombra); }
        .info-footer-box h4 { color: var(--negro); margin-top: 0; border-bottom: 2px solid var(--rojo); display: inline-block; padding-bottom: 5px; }

        #cart-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 3000; overflow-y: auto; }
        .cart-content { background: white; margin: 50px auto; width: 90%; max-width: 500px; border-radius: 20px; padding: 20px; position: relative; }
        .footer { position: fixed; bottom: 0; width: 100%; background: white; padding: 15px 0; text-align: center; z-index: 1000; box-shadow: 0 -10px 25px rgba(0,0,0,0.05); }
        .btn-ws { background: linear-gradient(135deg, var(--rojo), #b91d2c); color: white; border: none; padding: 15px; border-radius: 35px; width: 85%; font-weight: 700; cursor: pointer; text-transform: uppercase; }

        table { width: 100%; color: white; border-collapse: collapse; margin-top: 15px; font-size: 0.8rem; }
        th, td { border: 1px solid #333; padding: 8px; text-align: left; }
    </style>
</head>
<body onload="window.scrollTo(0,0);">

<div id="admin-panel">
    <h3>‚öôÔ∏è Panel Admin - Saul Taly</h3>
    <input type="number" id="adm-tasa" class="admin-in" placeholder="Tasa BCV">
    <input type="text" id="adm-rif" class="admin-in" placeholder="RIF">
    <textarea id="adm-desc" class="admin-in" placeholder="Descripci√≥n del Negocio"></textarea>
    <textarea id="adm-pago" class="admin-in" placeholder="Datos de Pago"></textarea>
    Logo: <input type="file" id="adm-logo-file" class="admin-in" accept="image/*">
    <button onclick="saveGlobalConfig()" style="width:100%; padding:10px; background:var(--rojo); color:white; border:none; border-radius:8px; font-weight:bold;">Actualizar Configuraci√≥n</button>
    <hr style="margin:20px 0; border:0.5px solid #333;">
    <h4 id="form-title">Gestionar Producto</h4>
    <input type="hidden" id="edit-id">
    <input type="text" id="add-n" class="admin-in" placeholder="Nombre">
    <input type="text" id="add-d" class="admin-in" placeholder="Descripci√≥n Corta">
    <input type="number" id="add-p" class="admin-in" placeholder="Precio $" step="0.01">
    <select id="add-tipo" class="admin-in">
        <option value="unidad">Venta por Unidad</option>
        <option value="peso">Venta por Peso (Kg)</option>
    </select>
    Imagen: <input type="file" id="add-img-file" class="admin-in" accept="image/*">
    <button onclick="uploadProd()" style="width:100%; padding:12px; background:#28a745; color:white; border:none; border-radius:8px; font-weight:bold;">Guardar Producto</button>
    <button id="btn-cancel" onclick="clearForm()" style="width:100%; margin-top:5px; display:none;">Cancelar</button>
    <div style="overflow-x:auto;"><table><thead><tr><th>Producto</th><th>Acci√≥n</th></tr></thead><tbody id="adm-body"></tbody></table></div>
    <button onclick="document.getElementById('admin-panel').style.display='none'" style="width:100%; margin-top:20px; padding:10px;">Cerrar Panel</button>
</div>

<header id="top-header">
    <div class="logo-btn" onmousedown="startHold()" onmouseup="endHold()" ontouchstart="startHold()" ontouchend="endHold()">
        <img id="logo-img" src="" style="display:none;">
        <span id="logo-txt">ST</span>
    </div>
    <h2 style="margin:0;">Emprendimiento Saul Taly</h2>
    <span class="slogan">¬°¬°Productos naturales para tu salud!!</span>
    <small id="rif-view" style="color:var(--rojo); font-weight:bold;"></small>
</header>

<div class="search-container">
    <input type="text" id="busqueda" placeholder="¬øQu√© est√°s buscando hoy?" oninput="render()">
    <span class="search-icon">üîç</span>
</div>

<div class="slider-container" id="swipe-area">
    <button class="nav-btn prev" onclick="moveSlide(-1)">‚ùÆ</button>
    <div class="slider-track" id="slider-track"></div>
    <button class="nav-btn next" onclick="moveSlide(1)">‚ùØ</button>
</div>

<div class="container">
    <div style="background:var(--negro); color:white; padding:12px; border-radius:15px; text-align:center; margin-bottom:20px; font-weight:bold;">
        TASA DEL D√çA: <span id="tasa-view">0.00</span> Bs/$
    </div>
    <div class="grid" id="main-grid"></div>
    <div class="info-footer-box">
        <h4>Datos de Pago</h4>
        <p id="view-pago" style="white-space: pre-wrap; font-size: 0.9rem; color: #555;"></p>
    </div>
    <div class="info-footer-box">
        <h4>Sobre Nosotros</h4>
        <p id="view-desc" style="white-space: pre-wrap; font-size: 0.9rem; color: #555;"></p>
    </div>
</div>

<div id="cart-modal">
    <div class="cart-content">
        <h3 style="margin-top:0;">üõí Detalle del Pedido</h3>
        <div id="cart-items-list"></div>
        <hr style="border:0.5px solid #eee; margin:15px 0;">
        <div style="text-align:right; font-weight:600;">
            Total USD: <span id="modal-total-usd">$0.00</span><br>
            Total Bs: <span id="modal-total-bs">0.00 Bs</span>
        </div>
        <button class="btn-ws" style="width:100%; margin-top:20px;" onclick="sendWS()">Enviar Pedido al WhatsApp</button>
        <button onclick="toggleCart(false)" style="width:100%; margin-top:10px; background:none; border:none; color:grey; cursor:pointer;">Seguir Comprando</button>
    </div>
</div>

<div class="footer">
    <button class="btn-ws" onclick="toggleCart(true)">
        Carrito (<span id="cart-count">0</span>) | <span id="total-view">$0.00</span>
    </button>
</div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyDIGqHCquBiPPvdxDDpk5QFbPfemJ8OxhE",
      authDomain: "emprendimientosaultaly.firebaseapp.com",
      databaseURL: "https://emprendimientosaultaly-default-rtdb.firebaseio.com",
      projectId: "emprendimientosaultaly",
      storageBucket: "emprendimientosaultaly.firebasestorage.app",
      messagingSenderId: "143582538940",
      appId: "1:143582538940:web:095c5c107529343be934b9"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let currentConfig = {}, currentItems = [], cart = {}, slideIndex = 0, holdTimer, autoSlide, touchX = 0;

    window.addEventListener('load', () => {
        setTimeout(() => { window.scrollTo(0, 0); }, 100);
    });

    db.ref('config').on('value', s => { 
        currentConfig = s.val() || {tasa:1, rif:'', logo:'', pago:'', desc:''}; 
        document.getElementById('tasa-view').innerText = parseFloat(currentConfig.tasa).toFixed(2);
        document.getElementById('rif-view').innerText = "RIF: " + currentConfig.rif;
        document.getElementById('view-pago').innerText = currentConfig.pago || "";
        document.getElementById('view-desc').innerText = currentConfig.desc || "";
        document.getElementById('adm-tasa').value = currentConfig.tasa || "";
        document.getElementById('adm-rif').value = currentConfig.rif || "";
        document.getElementById('adm-pago').value = currentConfig.pago || "";
        document.getElementById('adm-desc').value = currentConfig.desc || "";
        
        const logoImg = document.getElementById('logo-img');
        if(currentConfig.logo) { 
            logoImg.src = currentConfig.logo; 
            logoImg.style.display = 'block'; 
            document.getElementById('logo-txt').style.display = 'none'; 
        }
        render(); 
    });

    db.ref('productos').on('value', s => { 
        const data = s.val(); 
        currentItems = data ? Object.values(data) : []; 
        render(); 
        initSlider(); 
    });

    function render() {
        const busqueda = document.getElementById('busqueda').value.toLowerCase();
        const grid = document.getElementById('main-grid');
        grid.innerHTML = "";
        currentItems.forEach(p => {
            if (p.n.toLowerCase().includes(busqueda)) {
                const isPeso = p.tipo === 'peso';
                grid.innerHTML += `
                    <div class="card" id="prod-${p.id}">
                        <div class="img-wrap"><img src="${p.i || 'https://via.placeholder.com/150'}"></div>
                        <h4 style="margin:10px 0 5px">${p.n}</h4>
                        <p style="font-size:0.8rem; color:#777; margin:0;">${p.d || ''}</p>
                        <span class="price-bs">${(p.p * currentConfig.tasa).toFixed(2)} Bs</span>
                        <small style="color:grey;">$${p.p} / ${isPeso?'Kg':'Und'}</small>
                        <label class="cant-label">${isPeso?'':'Cantidad deseada por unidad'} ${isPeso?'<small style=>Cant. en kg (Ej: medio kg colocar 0.5)</small>':''}</label>
                        <input type="number" id="input-${p.id}" step="${isPeso?'0.001':'1'}" min="0" placeholder="0" 
                            oninput="validateAndUpd('${p.id}', this.value, '${p.tipo}')" 
                            class="admin-in" style="background:#fff; color:#000; border:1px solid #ddd; width:80%; margin:5px auto 15px;">
                    </div>`;
            }
        });
        updateCartUI();
        const admBody = document.getElementById('adm-body'); admBody.innerHTML = "";
        currentItems.forEach(p => { admBody.innerHTML += `<tr><td>${p.n}</td><td><button onclick="editProd('${p.id}')" style="color:cyan;background:none;border:none;">Edit</button> <button onclick="deleteProd('${p.id}')" style="color:red;background:none;border:none;">X</button></td></tr>`; });
    }

    function validateAndUpd(id, cant, tipo) {
        let val = parseFloat(cant); if(isNaN(val)) val = 0;
        if (tipo === 'unidad' && !Number.isInteger(val) && val > 0) { alert("‚ö†Ô∏è Error: Solo n√∫meros enteros."); document.getElementById('input-' + id).value = Math.floor(val); val = Math.floor(val); }
        const p = currentItems.find(x => x.id === id);
        if(val > 0) cart[id] = { n: p.n, p: p.p, c: val, u: (p.tipo==='peso'?'Kg':'Und') }; else delete cart[id]; 
        updateCartUI();
    }

    function updateCartUI() {
        let total = 0, count = 0; 
        const list = document.getElementById('cart-items-list'); 
        list.innerHTML = "";
        for(let id in cart) { 
            let sub = cart[id].p * cart[id].c; 
            total += sub; 
            count++; 
            list.innerHTML += `<div class="cart-item" style="display:flex; justify-content:space-between; margin-bottom:5px;"><span>${cart[id].n} (x${cart[id].c} ${cart[id].u})</span><b>$${sub.toFixed(2)}</b></div>`; 
        }
        // Actualiza el bot√≥n flotante y el modal
        document.getElementById('cart-count').innerText = count;
        document.getElementById('total-view').innerText = `$${total.toFixed(2)}`;
        document.getElementById('modal-total-usd').innerText = `$${total.toFixed(2)}`;
        document.getElementById('modal-total-bs').innerText = (total * currentConfig.tasa).toFixed(2) + " Bs";
    }

    function toggleCart(show) { document.getElementById('cart-modal').style.display = show ? 'block' : 'none'; }
    
    function sendWS() {
        if(Object.keys(cart).length === 0) return alert("El carrito est√° vac√≠o.");
        let m = "*üõçÔ∏è NUEVO PEDIDO - EMPRENDIMIENTO SAUL TALY*%0A";
        m += "----------------------------------------------------%0A";
        m += "üë§ _Hola, me gustar√≠a concretar el siguiente pedido:_%0A%0A";
        for(let id in cart) { m += `*‚Ä¢ ${cart[id].n}* x${cart[id].c} ${cart[id].u}%0A`; }
        m += `%0Aüíµ *TOTAL USD:* ${document.getElementById('modal-total-usd').innerText}%0A`;
        m += `üáªüá™ *TOTAL BS:* ${document.getElementById('modal-total-bs').innerText}%0A%0A`;
        m += "üí≥ _¬øMe podr√≠a confirmar la disponibilidad para realizar el pago?_";
        window.open(`https://wa.me/584126950652?text=${m}`);
    }

    function initSlider() {
        const track = document.getElementById('slider-track'); track.innerHTML = "";
        currentItems.forEach(p => { 
            track.innerHTML += `<div class="slide" onclick="scrollToProduct('${p.id}')">
                <img src="${p.i}">
                <div class="slide-info"><b>${p.n}</b></div>
            </div>`; 
        });
        startAutoSlide();
    }

    const area = document.getElementById('swipe-area');
    area.addEventListener('touchstart', e => touchX = e.touches[0].clientX);
    area.addEventListener('touchend', e => { let move = touchX - e.changedTouches[0].clientX; if(move > 50) moveSlide(1); else if(move < -50) moveSlide(-1); });

    function moveSlide(dir) { clearInterval(autoSlide); slideIndex = (slideIndex + dir + currentItems.length) % currentItems.length; document.getElementById('slider-track').style.transform = `translateX(-${slideIndex * 100}%)`; startAutoSlide(); }
    function startAutoSlide() { clearInterval(autoSlide); autoSlide = setInterval(() => { if(currentItems.length > 1) moveSlide(1); }, 4000); }
    function startHold() { holdTimer = setTimeout(() => { if(prompt("Acceso Admin:")==="230363230203") document.getElementById('admin-panel').style.display='block'; }, 3000); }
    function endHold() { clearTimeout(holdTimer); }
    function scrollToProduct(id) { const el = document.getElementById('prod-' + id); if(el) { el.scrollIntoView({ behavior: 'smooth' }); el.style.background = "#fff3f3"; setTimeout(() => el.style.background = "#fff", 1500); } }

    async function uploadProd() {
        const id = document.getElementById('edit-id').value || db.ref().child('productos').push().key;
        const file = document.getElementById('add-img-file').files[0];
        let img = (currentItems.find(x=>x.id===id)||{}).i || "";
        if(file) img = await toBase64(file);
        db.ref('productos/' + id).set({ id, n: document.getElementById('add-n').value, d: document.getElementById('add-d').value, p: parseFloat(document.getElementById('add-p').value) || 0, tipo: document.getElementById('add-tipo').value, i: img });
        alert("¬°Guardado!"); clearForm();
    }

    function editProd(id) {
        const p = currentItems.find(x => x.id === id);
        document.getElementById('edit-id').value = p.id; document.getElementById('add-n').value = p.n;
        document.getElementById('add-d').value = p.d || ""; document.getElementById('add-p').value = p.p;
        document.getElementById('add-tipo').value = p.tipo; document.getElementById('form-title').innerText = "Editando Producto";
        document.getElementById('btn-cancel').style.display = "block"; window.scrollTo(0,0);
    }
    function deleteProd(id) { if(confirm("¬øEliminar?")) db.ref('productos/' + id).remove(); }
    function clearForm() { document.getElementById('edit-id').value = ""; document.getElementById('add-n').value = ""; document.getElementById('add-d').value = ""; document.getElementById('add-p').value = ""; document.getElementById('form-title').innerText = "Gestionar Producto"; document.getElementById('btn-cancel').style.display = "none"; }
    async function saveGlobalConfig() {
        const file = document.getElementById('adm-logo-file').files[0];
        let logo = currentConfig.logo || ""; if(file) logo = await toBase64(file);
        db.ref('config').set({ tasa: parseFloat(document.getElementById('adm-tasa').value) || 0, rif: document.getElementById('adm-rif').value, pago: document.getElementById('adm-pago').value, desc: document.getElementById('adm-desc').value, logo: logo });
        alert("Configuraci√≥n Actualizada");
    }
    const toBase64 = f => new Promise(r => { const rd = new FileReader(); rd.onload = () => r(rd.result); });
</script>
</body>
</html>
        .cart-content { background: white; margin: 50px auto; width: 90%; max-width: 500px; border-radius: 20px; padding: 20px; position: relative; }
        .footer { position: fixed; bottom: 0; width: 100%; background: white; padding: 15px 0; text-align: center; z-index: 1000; box-shadow: 0 -10px 25px rgba(0,0,0,0.05); }
        .btn-ws { background: linear-gradient(135deg, var(--rojo), #b91d2c); color: white; border: none; padding: 15px; border-radius: 35px; width: 85%; font-weight: 700; cursor: pointer; text-transform: uppercase; }

        table { width: 100%; color: white; border-collapse: collapse; margin-top: 15px; font-size: 0.8rem; }
        th, td { border: 1px solid #333; padding: 8px; text-align: left; }
    </style>
</head>
<body onload="window.scrollTo(0,0);">

<div id="admin-panel">
    <h3>‚öôÔ∏è Panel Admin - Saul Taly</h3>
    <input type="number" id="adm-tasa" class="admin-in" placeholder="Tasa BCV">
    <input type="text" id="adm-rif" class="admin-in" placeholder="RIF">
    <textarea id="adm-desc" class="admin-in" placeholder="Descripci√≥n del Negocio"></textarea>
    <textarea id="adm-pago" class="admin-in" placeholder="Datos de Pago"></textarea>
    Logo: <input type="file" id="adm-logo-file" class="admin-in" accept="image/*">
    <button onclick="saveGlobalConfig()" style="width:100%; padding:10px; background:var(--rojo); color:white; border:none; border-radius:8px; font-weight:bold;">Actualizar Configuraci√≥n</button>
    <hr style="margin:20px 0; border:0.5px solid #333;">
    <h4 id="form-title">Gestionar Producto</h4>
    <input type="hidden" id="edit-id">
    <input type="text" id="add-n" class="admin-in" placeholder="Nombre">
    <input type="text" id="add-d" class="admin-in" placeholder="Descripci√≥n Corta">
    <input type="number" id="add-p" class="admin-in" placeholder="Precio $" step="0.01">
    <select id="add-tipo" class="admin-in">
        <option value="unidad">Venta por Unidad</option>
        <option value="peso">Venta por Peso (Kg)</option>
    </select>
    Imagen: <input type="file" id="add-img-file" class="admin-in" accept="image/*">
    <button onclick="uploadProd()" style="width:100%; padding:12px; background:#28a745; color:white; border:none; border-radius:8px; font-weight:bold;">Guardar Producto</button>
    <button id="btn-cancel" onclick="clearForm()" style="width:100%; margin-top:5px; display:none;">Cancelar</button>
    <div style="overflow-x:auto;"><table><thead><tr><th>Producto</th><th>Acci√≥n</th></tr></thead><tbody id="adm-body"></tbody></table></div>
    <button onclick="document.getElementById('admin-panel').style.display='none'" style="width:100%; margin-top:20px; padding:10px;">Cerrar Panel</button>
</div>

<header id="top-header">
    <div class="logo-btn" onmousedown="startHold()" onmouseup="endHold()" ontouchstart="startHold()" ontouchend="endHold()">
        <img id="logo-img" src="" style="display:none;">
        <span id="logo-txt">ST</span>
    </div>
    <h2 style="margin:0;">Emprendimiento Saul Taly</h2>
    <span class="slogan">¬°¬°Productos naturales para tu salud!!</span>
    <small id="rif-view" style="color:var(--rojo); font-weight:bold;"></small>
</header>

<div class="search-container">
    <input type="text" id="busqueda" placeholder="¬øQu√© est√°s buscando hoy?" oninput="render()">
    <span class="search-icon">üîç</span>
</div>

<div class="slider-container" id="swipe-area">
    <button class="nav-btn prev" onclick="moveSlide(-1)">‚ùÆ</button>
    <div class="slider-track" id="slider-track"></div>
    <button class="nav-btn next" onclick="moveSlide(1)">‚ùØ</button>
</div>

<div class="container">
    <div style="background:var(--negro); color:white; padding:12px; border-radius:15px; text-align:center; margin-bottom:20px; font-weight:bold;">
        TASA DEL D√çA: <span id="tasa-view">0.00</span> Bs/$
    </div>
    <div class="grid" id="main-grid"></div>
    <div class="info-footer-box">
        <h4>Datos de Pago</h4>
        <p id="view-pago" style="white-space: pre-wrap; font-size: 0.9rem; color: #555;"></p>
    </div>
    <div class="info-footer-box">
        <h4>Sobre Nosotros</h4>
        <p id="view-desc" style="white-space: pre-wrap; font-size: 0.9rem; color: #555;"></p>
    </div>
</div>

<div id="cart-modal">
    <div class="cart-content">
        <h3 style="margin-top:0;">üõí Detalle del Pedido</h3>
        <div id="cart-items-list"></div>
        <hr style="border:0.5px solid #eee; margin:15px 0;">
        <div style="text-align:right; font-weight:600;">
            Total USD: <span id="modal-total-usd">$0.00</span><br>
            Total Bs: <span id="modal-total-bs">0.00 Bs</span>
        </div>
        <button class="btn-ws" style="width:100%; margin-top:20px;" onclick="sendWS()">Enviar Pedido al WhatsApp</button>
        <button onclick="toggleCart(false)" style="width:100%; margin-top:10px; background:none; border:none; color:grey; cursor:pointer;">Seguir Comprando</button>
    </div>
</div>

<div class="footer">
    <button class="btn-ws" onclick="toggleCart(true)">
        Carrito (<span id="cart-count">0</span>) | <span id="total-view">$0.00</span>
    </button>
</div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyDIGqHCquBiPPvdxDDpk5QFbPfemJ8OxhE",
      authDomain: "emprendimientosaultaly.firebaseapp.com",
      databaseURL: "https://emprendimientosaultaly-default-rtdb.firebaseio.com",
      projectId: "emprendimientosaultaly",
      storageBucket: "emprendimientosaultaly.firebasestorage.app",
      messagingSenderId: "143582538940",
      appId: "1:143582538940:web:095c5c107529343be934b9"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let currentConfig = {}, currentItems = [], cart = {}, slideIndex = 0, holdTimer, autoSlide, touchX = 0;

    window.addEventListener('load', () => {
        setTimeout(() => { window.scrollTo(0, 0); }, 100);
    });

    db.ref('config').on('value', s => { 
        currentConfig = s.val() || {tasa:1, rif:'', logo:'', pago:'', desc:''}; 
        document.getElementById('tasa-view').innerText = parseFloat(currentConfig.tasa).toFixed(2);
        document.getElementById('rif-view').innerText = "RIF: " + currentConfig.rif;
        document.getElementById('view-pago').innerText = currentConfig.pago || "";
        document.getElementById('view-desc').innerText = currentConfig.desc || "";
        document.getElementById('adm-tasa').value = currentConfig.tasa || "";
        document.getElementById('adm-rif').value = currentConfig.rif || "";
        document.getElementById('adm-pago').value = currentConfig.pago || "";
        document.getElementById('adm-desc').value = currentConfig.desc || "";
        
        const logoImg = document.getElementById('logo-img');
        if(currentConfig.logo) { 
            logoImg.src = currentConfig.logo; 
            logoImg.style.display = 'block'; 
            document.getElementById('logo-txt').style.display = 'none'; 
        }
        render(); 
    });

    db.ref('productos').on('value', s => { 
        const data = s.val(); 
        currentItems = data ? Object.values(data) : []; 
        render(); 
        initSlider(); 
    });

    function render() {
        const busqueda = document.getElementById('busqueda').value.toLowerCase();
        const grid = document.getElementById('main-grid');
        grid.innerHTML = "";
        currentItems.forEach(p => {
            if (p.n.toLowerCase().includes(busqueda)) {
                const isPeso = p.tipo === 'peso';
                grid.innerHTML += `
                    <div class="card" id="prod-${p.id}">
                        <div class="img-wrap"><img src="${p.i || 'https://via.placeholder.com/150'}"></div>
                        <h4 style="margin:10px 0 5px">${p.n}</h4>
                        <p style="font-size:0.8rem; color:#777; margin:0;">${p.d || ''}</p>
                        <span class="price-bs">${(p.p * currentConfig.tasa).toFixed(2)} Bs</span>
                        <small style="color:grey;">$${p.p} / ${isPeso?'Kg':'Und'}</small>
                        <label class="cant-label">${isPeso?'':'Cantidad deseada por unidad'} ${isPeso?'<small style=>Cant. en kg (Ej: medio kg colocar 0.5)</small>':''}</label>
                        <input type="number" id="input-${p.id}" step="${isPeso?'0.001':'1'}" min="0" placeholder="0" 
                            oninput="validateAndUpd('${p.id}', this.value, '${p.tipo}')" 
                            class="admin-in" style="background:#fff; color:#000; border:1px solid #ddd; width:80%; margin:5px auto 15px;">
                    </div>`;
            }
        });
        updateCartUI();
        const admBody = document.getElementById('adm-body'); admBody.innerHTML = "";
        currentItems.forEach(p => { admBody.innerHTML += `<tr><td>${p.n}</td><td><button onclick="editProd('${p.id}')" style="color:cyan;background:none;border:none;">Edit</button> <button onclick="deleteProd('${p.id}')" style="color:red;background:none;border:none;">X</button></td></tr>`; });
    }

    function validateAndUpd(id, cant, tipo) {
        let val = parseFloat(cant); if(isNaN(val)) val = 0;
        if (tipo === 'unidad' && !Number.isInteger(val) && val > 0) { alert("‚ö†Ô∏è Error: Solo n√∫meros enteros."); document.getElementById('input-' + id).value = Math.floor(val); val = Math.floor(val); }
        const p = currentItems.find(x => x.id === id);
        if(val > 0) cart[id] = { n: p.n, p: p.p, c: val, u: (p.tipo==='peso'?'Kg':'Und') }; else delete cart[id]; updateCartUI();
    }

    function updateCartUI() {
        let total = 0, count = 0; const list = document.getElementById('cart-items-list'); list.innerHTML = "";
        for(let id in cart) { let sub = cart[id].p * cart[id].c; total += sub; count++; list.innerHTML += `<div class="cart-item"><span>${cart[id].n} (x${cart[id].c} ${cart[id].u})</span><b>$${sub.toFixed(2)}</b></div>`; }
        document.getElementById('cart-count').innerText = count;
        document.getElementById('total-view').innerText = `$${total.toFixed(2)}`;
        document.getElementById('modal-total-usd').innerText = `$${total.toFixed(2)}`;
        document.getElementById('modal-total-bs').innerText = (total * currentConfig.tasa).toFixed(2) + " Bs";
    }

    function toggleCart(show) { document.getElementById('cart-modal').style.display = show ? 'block' : 'none'; }
    
    // RESTAURACI√ìN DEL MEMBRETE SOLICITADO
    function sendWS() {
        if(Object.keys(cart).length === 0) return alert("El carrito est√° vac√≠o.");
        let m = "*üõçÔ∏è NUEVO PEDIDO - EMPRENDIMIENTO SAUL TALY*%0A";
        m += "----------------------------------------------------%0A";
        m += "üë§ _Hola, me gustar√≠a concretar el siguiente pedido:_%0A%0A";
        
        for(let id in cart) {
            m += `*‚Ä¢ ${cart[id].n}* x${cart[id].c} ${cart[id].u}%0A`;
        }
        
        m += `%0Aüíµ *TOTAL USD:* ${document.getElementById('modal-total-usd').innerText}%0A`;
        m += `üáªüá™ *TOTAL BS:* ${document.getElementById('modal-total-bs').innerText}%0A%0A`;
        m += "üí≥ _¬øMe podr√≠a confirmar la disponibilidad para realizar el pago?_";
        
        window.open(`https://wa.me/584126950652?text=${m}`);
    }

    function initSlider() {
        const track = document.getElementById('slider-track'); track.innerHTML = "";
        currentItems.forEach(p => { 
            track.innerHTML += `<div class="slide" onclick="scrollToProduct('${p.id}')">
                <img src="${p.i}">
                <div class="slide-info"><b>${p.n}</b></div>
            </div>`; 
        });
        startAutoSlide();
    }

    const area = document.getElementById('swipe-area');
    area.addEventListener('touchstart', e => touchX = e.touches[0].clientX);
    area.addEventListener('touchend', e => { let move = touchX - e.changedTouches[0].clientX; if(move > 50) moveSlide(1); else if(move < -50) moveSlide(-1); });

    function moveSlide(dir) { clearInterval(autoSlide); slideIndex = (slideIndex + dir + currentItems.length) % currentItems.length; document.getElementById('slider-track').style.transform = `translateX(-${slideIndex * 100}%)`; startAutoSlide(); }
    function startAutoSlide() { clearInterval(autoSlide); autoSlide = setInterval(() => { if(currentItems.length > 1) moveSlide(1); }, 4000); }
    function startHold() { holdTimer = setTimeout(() => { if(prompt("Acceso Admin:")==="230363230203") document.getElementById('admin-panel').style.display='block'; }, 3000); }
    function endHold() { clearTimeout(holdTimer); }
    function scrollToProduct(id) { const el = document.getElementById('prod-' + id); if(el) { el.scrollIntoView({ behavior: 'smooth' }); el.style.background = "#fff3f3"; setTimeout(() => el.style.background = "#fff", 1500); } }

    async function uploadProd() {
        const id = document.getElementById('edit-id').value || db.ref().child('productos').push().key;
        const file = document.getElementById('add-img-file').files[0];
        let img = (currentItems.find(x=>x.id===id)||{}).i || "";
        if(file) img = await toBase64(file);
        db.ref('productos/' + id).set({ id, n: document.getElementById('add-n').value, d: document.getElementById('add-d').value, p: parseFloat(document.getElementById('add-p').value) || 0, tipo: document.getElementById('add-tipo').value, i: img });
        alert("¬°Guardado!"); clearForm();
    }

    function editProd(id) {
        const p = currentItems.find(x => x.id === id);
        document.getElementById('edit-id').value = p.id; document.getElementById('add-n').value = p.n;
        document.getElementById('add-d').value = p.d || ""; document.getElementById('add-p').value = p.p;
        document.getElementById('add-tipo').value = p.tipo; document.getElementById('form-title').innerText = "Editando Producto";
        document.getElementById('btn-cancel').style.display = "block"; window.scrollTo(0,0);
    }
    function deleteProd(id) { if(confirm("¬øEliminar?")) db.ref('productos/' + id).remove(); }
    function clearForm() { document.getElementById('edit-id').value = ""; document.getElementById('add-n').value = ""; document.getElementById('add-d').value = ""; document.getElementById('add-p').value = ""; document.getElementById('form-title').innerText = "Gestionar Producto"; document.getElementById('btn-cancel').style.display = "none"; }
    async function saveGlobalConfig() {
        const file = document.getElementById('adm-logo-file').files[0];
        let logo = currentConfig.logo || ""; if(file) logo = await toBase64(file);
        db.ref('config').set({ tasa: parseFloat(document.getElementById('adm-tasa').value) || 0, rif: document.getElementById('adm-rif').value, pago: document.getElementById('adm-pago').value, desc: document.getElementById('adm-desc').value, logo: logo });
        alert("Configuraci√≥n Actualizada");
    }
    const toBase64 = f => new Promise(r => { const rd = new FileReader(); rd.onload = () => r(rd.result); });
</script>
</body>
</html>
        #logo-img { width: 100%; height: 100%; object-fit: cover; display: block; }
        #logo-txt { position: absolute; color: white; font-weight: bold; font-size: 1.5rem; }
        .slogan { color: #666; font-size: 0.85rem; display: block; margin-top: 5px; font-weight: 300; }

        /* BUSCADOR */
        .search-container { width: 90%; max-width: 500px; margin: 20px auto; position: relative; }
        .search-container input { 
            width: 100%; padding: 12px 45px 12px 20px; border-radius: 25px; border: 1px solid #ddd; 
            box-shadow: var(--sombra); outline: none; font-family: inherit; box-sizing: border-box;
        }
        .search-icon { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--rojo); font-size: 1.2rem; }
        
        /* CARRUSEL */
        .slider-container { width: 92%; margin: 20px auto; overflow: hidden; background: #fff; height: 220px; position: relative; border-radius: 25px; box-shadow: var(--sombra); touch-action: pan-y; }
        .slider-track { display: flex; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); height: 100%; }
        .slide { min-width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; }
        .slide img { height: 100%; width: 100%; object-fit: contain; padding: 10px; box-sizing: border-box; }
        .slide-info { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(29, 53, 87, 0.9)); color: white; padding: 15px; text-align: center; }
        .slide-info b { font-size: 1.1rem; text-transform: uppercase; letter-spacing: 1px; }

        .nav-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.4); color: white; border: none; padding: 15px 10px; cursor: pointer; border-radius: 5px; z-index: 10; font-weight: bold; }
        .prev { left: 5px; } .next { right: 5px; }

        /* GRID Y CARDS */
        .container { padding: 20px; max-width: 1000px; margin: auto; padding-bottom: 150px; } 
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(170px, 1fr)); gap: 20px; }
        .card { border: none; border-radius: 20px; padding: 15px; text-align: center; background: white; box-shadow: var(--sombra); scroll-margin-top: 100px; transition: transform 0.3s ease; }
        .img-wrap { width: 100%; height: 160px; overflow: hidden; border-radius: 15px; margin-bottom: 10px; }
        .card img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .card:hover img { transform: scale(1.15); } 
        
        .price-bs { color: var(--rojo); font-weight: 700; font-size: 1.1rem; display: block; margin-top: 5px; }
        .cant-label { font-size: 0.75rem; color: #666; font-weight: 600; display: block; margin-top: 10px; }
        
        .info-footer-box { background: white; padding: 20px; border-radius: 20px; margin-top: 30px; box-shadow: var(--sombra); }
        .info-footer-box h4 { color: var(--negro); margin-top: 0; border-bottom: 2px solid var(--rojo); display: inline-block; padding-bottom: 5px; }

        #cart-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 3000; overflow-y: auto; }
        .cart-content { background: white; margin: 50px auto; width: 90%; max-width: 500px; border-radius: 20px; padding: 20px; position: relative; }
        .footer { position: fixed; bottom: 0; width: 100%; background: white; padding: 15px 0; text-align: center; z-index: 1000; box-shadow: 0 -10px 25px rgba(0,0,0,0.05); }
        .btn-ws { background: linear-gradient(135deg, var(--rojo), #b91d2c); color: white; border: none; padding: 15px; border-radius: 35px; width: 85%; font-weight: 700; cursor: pointer; text-transform: uppercase; }

        table { width: 100%; color: white; border-collapse: collapse; margin-top: 15px; font-size: 0.8rem; }
        th, td { border: 1px solid #333; padding: 8px; text-align: left; }
    </style>
</head>
<body onload="window.scrollTo(0,0);">

<div id="admin-panel">
    <h3>‚öôÔ∏è Panel Admin - Saul Taly</h3>
    <input type="number" id="adm-tasa" class="admin-in" placeholder="Tasa BCV">
    <input type="text" id="adm-rif" class="admin-in" placeholder="RIF">
    <textarea id="adm-desc" class="admin-in" placeholder="Descripci√≥n del Negocio"></textarea>
    <textarea id="adm-pago" class="admin-in" placeholder="Datos de Pago"></textarea>
    Logo: <input type="file" id="adm-logo-file" class="admin-in" accept="image/*">
    <button onclick="saveGlobalConfig()" style="width:100%; padding:10px; background:var(--rojo); color:white; border:none; border-radius:8px; font-weight:bold;">Actualizar Configuraci√≥n</button>
    <hr style="margin:20px 0; border:0.5px solid #333;">
    <h4 id="form-title">Gestionar Producto</h4>
    <input type="hidden" id="edit-id">
    <input type="text" id="add-n" class="admin-in" placeholder="Nombre">
    <input type="text" id="add-d" class="admin-in" placeholder="Descripci√≥n Corta">
    <input type="number" id="add-p" class="admin-in" placeholder="Precio $" step="0.01">
    <select id="add-tipo" class="admin-in">
        <option value="unidad">Venta por Unidad</option>
        <option value="peso">Venta por Peso (Kg)</option>
    </select>
    Imagen: <input type="file" id="add-img-file" class="admin-in" accept="image/*">
    <button onclick="uploadProd()" style="width:100%; padding:12px; background:#28a745; color:white; border:none; border-radius:8px; font-weight:bold;">Guardar Producto</button>
    <button id="btn-cancel" onclick="clearForm()" style="width:100%; margin-top:5px; display:none;">Cancelar</button>
    <div style="overflow-x:auto;"><table><thead><tr><th>Producto</th><th>Acci√≥n</th></tr></thead><tbody id="adm-body"></tbody></table></div>
    <button onclick="document.getElementById('admin-panel').style.display='none'" style="width:100%; margin-top:20px; padding:10px;">Cerrar Panel</button>
</div>

<header id="top-header">
    <div class="logo-btn" onmousedown="startHold()" onmouseup="endHold()" ontouchstart="startHold()" ontouchend="endHold()">
        <img id="logo-img" src="" style="display:none;">
        <span id="logo-txt">ST</span>
    </div>
    <h2 style="margin:0;">Emprendimiento Saul Taly</h2>
    <span class="slogan">¬°¬°Productos naturales para tu salud!!</span>
    <small id="rif-view" style="color:var(--rojo); font-weight:bold;"></small>
</header>

<div class="search-container">
    <input type="text" id="busqueda" placeholder="¬øQu√© est√°s buscando hoy?" oninput="render()">
    <span class="search-icon">üîç</span>
</div>

<div class="slider-container" id="swipe-area">
    <button class="nav-btn prev" onclick="moveSlide(-1)">‚ùÆ</button>
    <div class="slider-track" id="slider-track"></div>
    <button class="nav-btn next" onclick="moveSlide(1)">‚ùØ</button>
</div>

<div class="container">
    <div style="background:var(--negro); color:white; padding:12px; border-radius:15px; text-align:center; margin-bottom:20px; font-weight:bold;">
        TASA DEL D√çA: <span id="tasa-view">0.00</span> Bs/$
    </div>
    <div class="grid" id="main-grid"></div>
    <div class="info-footer-box">
        <h4>Datos de Pago</h4>
        <p id="view-pago" style="white-space: pre-wrap; font-size: 0.9rem; color: #555;"></p>
    </div>
    <div class="info-footer-box">
        <h4>Sobre Nosotros</h4>
        <p id="view-desc" style="white-space: pre-wrap; font-size: 0.9rem; color: #555;"></p>
    </div>
</div>

<div id="cart-modal">
    <div class="cart-content">
        <h3 style="margin-top:0;">üõí Detalle del Pedido</h3>
        <div id="cart-items-list"></div>
        <hr style="border:0.5px solid #eee; margin:15px 0;">
        <div style="text-align:right; font-weight:600;">
            Total USD: <span id="modal-total-usd">$0.00</span><br>
            Total Bs: <span id="modal-total-bs">0.00 Bs</span>
        </div>
        <button class="btn-ws" style="width:100%; margin-top:20px;" onclick="sendWS()">Enviar Pedido al WhatsApp</button>
        <button onclick="toggleCart(false)" style="width:100%; margin-top:10px; background:none; border:none; color:grey; cursor:pointer;">Seguir Comprando</button>
    </div>
</div>

<div class="footer">
    <button class="btn-ws" onclick="toggleCart(true)">
        Carrito (<span id="cart-count">0</span>) | <span id="total-view">$0.00</span>
    </button>
</div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyDIGqHCquBiPPvdxDDpk5QFbPfemJ8OxhE",
      authDomain: "emprendimientosaultaly.firebaseapp.com",
      databaseURL: "https://emprendimientosaultaly-default-rtdb.firebaseio.com",
      projectId: "emprendimientosaultaly",
      storageBucket: "emprendimientosaultaly.firebasestorage.app",
      messagingSenderId: "143582538940",
      appId: "1:143582538940:web:095c5c107529343be934b9"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let currentConfig = {}, currentItems = [], cart = {}, slideIndex = 0, holdTimer, autoSlide, touchX = 0;

    window.addEventListener('load', () => {
        setTimeout(() => { window.scrollTo(0, 0); }, 100);
    });

    // CORRECCI√ìN: Carga los datos guardados en los inputs del Panel Admin al iniciar
    db.ref('config').on('value', s => { 
        currentConfig = s.val() || {tasa:1, rif:'', logo:'', pago:'', desc:''}; 
        
        // Poner datos en la vista p√∫blica
        document.getElementById('tasa-view').innerText = parseFloat(currentConfig.tasa).toFixed(2);
        document.getElementById('rif-view').innerText = "RIF: " + currentConfig.rif;
        document.getElementById('view-pago').innerText = currentConfig.pago || "";
        document.getElementById('view-desc').innerText = currentConfig.desc || "";

        // Poner datos en los inputs del Panel Admin (Para que no salgan en blanco)
        document.getElementById('adm-tasa').value = currentConfig.tasa || "";
        document.getElementById('adm-rif').value = currentConfig.rif || "";
        document.getElementById('adm-pago').value = currentConfig.pago || "";
        document.getElementById('adm-desc').value = currentConfig.desc || "";
        
        const logoImg = document.getElementById('logo-img');
        if(currentConfig.logo) { 
            logoImg.src = currentConfig.logo; 
            logoImg.style.display = 'block'; 
            document.getElementById('logo-txt').style.display = 'none'; 
        }
        render(); 
    });

    db.ref('productos').on('value', s => { 
        const data = s.val(); 
        currentItems = data ? Object.values(data) : []; 
        render(); 
        initSlider(); 
    });

    function render() {
        const busqueda = document.getElementById('busqueda').value.toLowerCase();
        const grid = document.getElementById('main-grid');
        grid.innerHTML = "";
        currentItems.forEach(p => {
            if (p.n.toLowerCase().includes(busqueda)) {
                const isPeso = p.tipo === 'peso';
                grid.innerHTML += `
                    <div class="card" id="prod-${p.id}">
                        <div class="img-wrap"><img src="${p.i || 'https://via.placeholder.com/150'}"></div>
                        <h4 style="margin:10px 0 5px">${p.n}</h4>
                        <p style="font-size:0.8rem; color:#777; margin:0;">${p.d || ''}</p>
                        <span class="price-bs">${(p.p * currentConfig.tasa).toFixed(2)} Bs</span>
                        <small style="color:grey;">$${p.p} / ${isPeso?'Kg':'Und'}</small>
                        <label class="cant-label">${isPeso?'':'Cantidad deseada por unidad'} ${isPeso?'<small style=>Cant. en kg (Ej: medio kg colocar 0.5)</small>':''}</label>
                        <input type="number" id="input-${p.id}" step="${isPeso?'0.001':'1'}" min="0" placeholder="0" 
                            oninput="validateAndUpd('${p.id}', this.value, '${p.tipo}')" 
                            class="admin-in" style="background:#fff; color:#000; border:1px solid #ddd; width:80%; margin:5px auto 15px;">
                    </div>`;
            }
        });
        updateCartUI();
        const admBody = document.getElementById('adm-body'); admBody.innerHTML = "";
        currentItems.forEach(p => { admBody.innerHTML += `<tr><td>${p.n}</td><td><button onclick="editProd('${p.id}')" style="color:cyan;background:none;border:none;">Edit</button> <button onclick="deleteProd('${p.id}')" style="color:red;background:none;border:none;">X</button></td></tr>`; });
    }

    function validateAndUpd(id, cant, tipo) {
        let val = parseFloat(cant); if(isNaN(val)) val = 0;
        if (tipo === 'unidad' && !Number.isInteger(val) && val > 0) { alert("‚ö†Ô∏è Error: Solo n√∫meros enteros."); document.getElementById('input-' + id).value = Math.floor(val); val = Math.floor(val); }
        const p = currentItems.find(x => x.id === id);
        if(val > 0) cart[id] = { n: p.n, p: p.p, c: val, u: (p.tipo==='peso'?'Kg':'Und') }; else delete cart[id]; updateCartUI();
    }

    function updateCartUI() {
        let total = 0, count = 0; const list = document.getElementById('cart-items-list'); list.innerHTML = "";
        for(let id in cart) { let sub = cart[id].p * cart[id].c; total += sub; count++; list.innerHTML += `<div class="cart-item"><span>${cart[id].n} (x${cart[id].c} ${cart[id].u})</span><b>$${sub.toFixed(2)}</b></div>`; }
        document.getElementById('cart-count').innerText = count;
        document.getElementById('total-view').innerText = `$${total.toFixed(2)}`;
        document.getElementById('modal-total-usd').innerText = `$${total.toFixed(2)}`;
        document.getElementById('modal-total-bs').innerText = (total * currentConfig.tasa).toFixed(2) + " Bs";
    }

    function toggleCart(show) { document.getElementById('cart-modal').style.display = show ? 'block' : 'none'; }
    function sendWS() {
        if(Object.keys(cart).length === 0) return alert("El carrito est√° vac√≠o.");
        let m = "*üõçÔ∏è NUEVO PEDIDO - EMPRENDIMIENTO SAUL TALY*%0A%0A";
        for(let id in cart) m += `‚Ä¢ ${cart[id].n}: ${cart[id].c} ${cart[id].u} ($${(cart[id].p * cart[id].c).toFixed(2)})%0A`;
        m += `%0Aüí∞ *TOTAL USD:* ${document.getElementById('modal-total-usd').innerText}%0Aüáªüá™ *TOTAL BS:* ${document.getElementById('modal-total-bs').innerText}`;
        window.open(`https://wa.me/584126950652?text=${m}`);
    }

    function initSlider() {
        const track = document.getElementById('slider-track'); track.innerHTML = "";
        currentItems.forEach(p => { 
            track.innerHTML += `<div class="slide" onclick="scrollToProduct('${p.id}')">
                <img src="${p.i}">
                <div class="slide-info"><b>${p.n}</b></div>
            </div>`; 
        });
        startAutoSlide();
    }

    const area = document.getElementById('swipe-area');
    area.addEventListener('touchstart', e => touchX = e.touches[0].clientX);
    area.addEventListener('touchend', e => { let move = touchX - e.changedTouches[0].clientX; if(move > 50) moveSlide(1); else if(move < -50) moveSlide(-1); });

    function moveSlide(dir) { clearInterval(autoSlide); slideIndex = (slideIndex + dir + currentItems.length) % currentItems.length; document.getElementById('slider-track').style.transform = `translateX(-${slideIndex * 100}%)`; startAutoSlide(); }
    function startAutoSlide() { clearInterval(autoSlide); autoSlide = setInterval(() => { if(currentItems.length > 1) moveSlide(1); }, 4000); }
    function startHold() { holdTimer = setTimeout(() => { if(prompt("Acceso Admin:")==="230363230203") document.getElementById('admin-panel').style.display='block'; }, 3000); }
    function endHold() { clearTimeout(holdTimer); }
    function scrollToProduct(id) { const el = document.getElementById('prod-' + id); if(el) { el.scrollIntoView({ behavior: 'smooth' }); el.style.background = "#fff3f3"; setTimeout(() => el.style.background = "#fff", 1500); } }

    async function uploadProd() {
        const id = document.getElementById('edit-id').value || db.ref().child('productos').push().key;
        const file = document.getElementById('add-img-file').files[0];
        let img = (currentItems.find(x=>x.id===id)||{}).i || "";
        if(file) img = await toBase64(file);
        db.ref('productos/' + id).set({ id, n: document.getElementById('add-n').value, d: document.getElementById('add-d').value, p: parseFloat(document.getElementById('add-p').value) || 0, tipo: document.getElementById('add-tipo').value, i: img });
        alert("¬°Guardado!"); clearForm();
    }

    function editProd(id) {
        const p = currentItems.find(x => x.id === id);
        document.getElementById('edit-id').value = p.id; document.getElementById('add-n').value = p.n;
        document.getElementById('add-d').value = p.d || ""; document.getElementById('add-p').value = p.p;
        document.getElementById('add-tipo').value = p.tipo; document.getElementById('form-title').innerText = "Editando Producto";
        document.getElementById('btn-cancel').style.display = "block"; window.scrollTo(0,0);
    }
    function deleteProd(id) { if(confirm("¬øEliminar?")) db.ref('productos/' + id).remove(); }
    function clearForm() { document.getElementById('edit-id').value = ""; document.getElementById('add-n').value = ""; document.getElementById('add-d').value = ""; document.getElementById('add-p').value = ""; document.getElementById('form-title').innerText = "Gestionar Producto"; document.getElementById('btn-cancel').style.display = "none"; }
    async function saveGlobalConfig() {
        const file = document.getElementById('adm-logo-file').files[0];
        let logo = currentConfig.logo || ""; if(file) logo = await toBase64(file);
        db.ref('config').set({ tasa: parseFloat(document.getElementById('adm-tasa').value) || 0, rif: document.getElementById('adm-rif').value, pago: document.getElementById('adm-pago').value, desc: document.getElementById('adm-desc').value, logo: logo });
        alert("Configuraci√≥n Actualizada");
    }
    const toBase64 = f => new Promise(r => { const rd = new FileReader(); rd.onload = () => r(rd.result); });
</script>
</body>
</html>
